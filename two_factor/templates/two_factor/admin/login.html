{% extends "admin/login.html" %}

{% load i18n admin_static two_factor %}

{% block extrastyle %}{{ block.super }}{% include "two_factor/admin/_style.html" %}{% endblock %}

{% block content %}
{% if form.errors and not form.non_field_errors and not form.this_is_the_login_form.errors %}
<p class="errornote">
{% if form.errors.items|length == 1 %}{% trans "Please correct the error below." %}{% else %}{% trans "Please correct the errors below." %}{% endif %}
</p>
{% endif %}

{% if form.non_field_errors or form.this_is_the_login_form.errors %}
{% for error in form.non_field_errors|add:form.this_is_the_login_form.errors %}
<p class="errornote">
    {{ error }}
</p>
{% endfor %}
{% endif %}

<div id="content-main">
<form action="{{ app_path }}" method="post" id="login-form">{% csrf_token %}
  <div class="form-row">
  {% if wizard.steps.current == 'auth' %}
    {% blocktrans %}Enter your credentials.{% endblocktrans %}
  {% elif wizard.steps.current == 'token' %}
    {% if device.method == 'call' %}
      {% blocktrans %}We are calling your phone right now, please enter the digits you hear.{% endblocktrans %}
    {% elif device.method == 'sms' %}
      {% blocktrans %}We sent you a text message, please enter the tokens we sent.{% endblocktrans %}
    {% else %}
      {% blocktrans %}Please enter the tokens generated by your token generator.{% endblocktrans %}
    {% endif %}
  {% elif wizard.steps.current == 'backup' %}
    {% blocktrans %}Use this form for entering backup tokens for logging in. These tokens have been generated for you to print and keep safe. Please enter one of these backup tokens to login to your account.{% endblocktrans %}
  {% endif %}
  </div>

  {% include "two_factor/_wizard_forms.html" %}

  {% include "two_factor/admin/_wizard_actions.html" %}

  {% if other_devices %}
    <div class="form-row">
      {% trans "Or, alternatively, use one of your backup phones:" %}</p>
    </div>
    <div class="form-row">
      {% for other in other_devices %}
        <input name="challenge_device" value="{{ other.persistent_id }}" class="btn btn-default btn-block"type="submit">{{ other|device_action }}</input>
      {% endfor %}
    </div>
  {% endif %}

  {% if backup_tokens %}
    <div class="form-row">
      <label>{% trans "As a last resort, you can use a backup token:" %}</label>
      <button name="wizard_goto_step" type="submit" value="backup" class="btn btn-default btn-block">{% trans "Use Backup Token" %}</button>
    </div>
  {% endif %}

</form>

</div>
{% endblock %}
